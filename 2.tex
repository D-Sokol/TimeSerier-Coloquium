% Ляпуновский показатель. Вычисление ляпуновского показателя в случае анализа систем, заданных аналитически.

Погрешность предсказания любого временного ряда меняется по следующему закону:
\begin{equation*}
    \eps_t = \eps_0 e^{\lambda t},
\end{equation*}
где $\eps_0$ -- погрешность последнего известного значения ряда, $\eps_t$ -- погрешность предсказания $t$ шагов спустя, $\lambda = \const$ -- \textbf{старший показатель Ляпунова}. В случае регулярных рядов $\lambda < 0$, в случае хаотических -- $\lambda > 0$.

Отсюда следует, что для хаотических рядов существует \textbf{горизонт прогнозируемости} -- количество шагов $T$, такое, что после него погрешность любого предсказания превышает допустимый порог $\eps_{\text{max}}$: $T \sim \frac{1}{\lambda} \ln \frac{\eps_{\text{max}}}{\eps_0}$.

Пусть рассматриваемый временной ряд соответствует динамической системе $\dot{x} = f(x)$.
Зафиксируем точку $x(t)$, принадлежащую какой-либо траектории. Рассмотрим малое возмущение этой траектории $x(t) + \eps u(t)$, также являющееся решением уравенения $\dot{x} = f(x)$.
Подставляя разность двух рассматриваемых решений в уравнение, получаем следующее соотношение (считая, что $f$ дифференцируема):
\begin{gather}
\nonumber
    \eps \dot{u} = 
    \left( x(t) + \eps u(t) \right) - f\left( x(t) \right) =
    \left. \frac{\partial f}{\partial x_i} \right|_{x=x(t)} \cdot \eps u(t) + O\left( \eps \right), \\
\label{2_1}
    \dot{u}(t) = \nabla f \big|_{x(t)} \cdot u(t) = A(x(t)) \cdot u(t).
\end{gather}

Уравнение \eqref{2_1} называется линеаризацией динамической системы на траектории $x(t)$.
Очевидно, что тождественный ноль является решением линеаризованной системы.

При этом важно отметить, что, вообще говоря, $x$ и $u$ не лежат в одном пространстве: $x$ является элементом фазового пространства, $u$ лежит в касательном пространстве, построенном в точке $x$.
Эволюция возмущения траектории позволяет определить характеристической показатель Ляпунова $\lambda = \lim_{T \to \infty} \frac{1}{T} \ln \frac{\| u(T) \|}{\| u(0) \|}$.
В зависимости от начальных условий характеристический показатель может принимать только значения из Ляпуновского спектра, то есть максимум $n$ различных условий.
Если хотя бы один показатель положителен, то система является хаотической, в случае, когда положительны несколько показателей, говорят о гиперхаосе.

Если явный вид системы известен, что бывает чуть менее, чем никогда, то для нахождения спектра показателей Ляпунова можно применить алгоритм Бенеттина:
\begin{enumerate}
\item
    Рассмотрим совместно уравнение исходной динамической системы и $n$ линеаризованных систем с ортонормированными начальными условиями.
    Удобно выбрать в качестве начальных условий для $i$-й системы вектор $e_i = \left( \delta_{ji} \right)_{j=1}^{n}$.
    Полученная система в сумме состоит из $n\cdot\left( n+1 \right)$ скалярных уравнений.
\item
    Будем одновременно проводить численное интерирование всех систем, используя метод Рунге-Кутта 4 порядка.
\item
    Также на каждом шаге вычисляем весь набор \textbf{объемных показателей Ляпунова}, пользуясь любым определением скалярного произведения:
    \begin{equation*}
        \hat{\kappa}_j(t) = \ln \sqrt{\det \begin{pmatrix}
            \left( u_1, u_1 \right) & \dots & \left( u_1, u_j \right)\\
            \vdots & \ddots & \vdots\\
            \left( u_j, u_1 \right) & \dots & \left( u_j, u_j \right)
        \end{pmatrix} }
    \end{equation*}
\item
    После каждого шага интегрирования будем производить ОГШ для решений линеаризованных систем, так, чтобы их решения оставались ортонормированными.
    При этом обязательно нужно учитывать, что на каждом шаге сначала вектора возмущений $u$ эволюционируют во времени в соответствии с линеаризованной матрицей системы в точке $x(t)$, затем вычисляются $\hat{\kappa}_j(t)$ и только затем производится ортогонализация.
\item
    В пределе при $t \to \infty$ находим значения объемных показателей Ляпунова, усредняя по времени:
    \begin{equation*}
        \kappa_j = \frac{1}{t} \sum_{\tau=1}^{t} \hat{\kappa}_j(\tau).
    \end{equation*}
    Так как $\kappa_j = \sum_{i=1}^{j} \lambda_j$, то разности соседних $\kappa_j$ дают показатели Ляпунова.
\end{enumerate}

