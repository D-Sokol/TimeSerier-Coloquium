% Ляпуновский показатель. Вычисление ляпуновского показателя по временному ряду. Метод аналога. Фрейм-разложение.

Рассмотрим временной ряд (возможно, многомерный) $x_i$. Тогда для данного ряда можно построить \textbf{ряд $z$-векторов}, каждый элемент которого определяется следующим образом:
\begin{equation*}
    \vec z_i = \begin{pmatrix}
        x_i & x_{i+1} & \dots & x_{i+d-1}
    \end{pmatrix}^T,
\end{equation*}
$d = \const$ -- размерность вложения.

Построенный ряд можно использовать для оценки показателей Ляпунова. Для этого находятся пары близких $z$-векторов, после чего один из них рассматривается как возмущенная версия другого. Рассмотрим конкретные алгоритмы.

Метод аналога:
\begin{enumerate}
\item
    Для вектора <<основной траектории>> $z_i$ находим его ближайшего соседа $z_{j_1}$;
\item
    Обозначим разность между ними как $u_1(i+t) = z_{i+t} - z_{j_1+t}$.
    Для каждой такой пары $(i, j_1)$ траектории расходятся, то есть норма вектора $u_1(t)$ экспоненциально возрастает.
    В момент $t_1$, когда норма достигнет некоторого порога $\eps_2 = \const$, вектор $z_{j_1+t_1}$ заменяется на другой вектор $z_{j_2}$, ближайший к исходной траектории $z_{i+t_1}$ в момент времени смены.
    Этот вектор также в какой-то момент $t_2$ заменяется на $z_{j_3}$ и так далее.
\item
    Оценка старшего показателя Ляпунова вычисляется по следующей формуле:
    \begin{equation}
    \label{3_1}
        \hat{\lambda}_1 = 
        \frac{1}{t_p - t_0} \left(
            \ln \frac{\|u_1(t_1)\|}{\|u_1(t_0)\|} +
            \ln \frac{\|u_2(t_2)\|}{\|u_2(t_1)\|} +
            \dots +
            \ln \frac{\|u_p(t_p)\|}{\|u_p(t_{p-1})\|}
        \right),
    \end{equation}
    где $p$ -- количество различных <<ближайших соседей>>, использованных в процессе.
    Заметим, что если $p=1$, то есть расхождение на расстояние $\eps_2$ так и не произошло, то формула \eqref{3_1} соответствует формуле погрешности вычисления временного ряда:
    \begin{equation*}
        \lambda = \frac{1}{t} \ln \frac{\eps_{\text{max}}}{\eps_0} = \frac{1}{t} \ln \frac{\|u(t)\|}{\|u(0)\|}
    \end{equation*}
\end{enumerate}


Метод фрейм-разложения можно рассматривать как способ применить алгоритм Бенеттина, не зная явного вида уравнения динамической системы.
Формально, для использования алгоритма Бенеттина достаточно уметь вычислять две вещи: значения $z$ в точках $t = t_0, t_0+\tau, t_0+2\tau, \dots$ и применять к любому вектору возмущения $u(t) = \frac{\phi^t\left( x(0)+\eps u(0) \right) - \phi^t\left( x(0) \right)}{\eps}$ оператор временной эволюции $Df: u(t) \mapsto u(t+\tau)$.
Значения вектора $z$ по определению представляют собой известный временной ряд, поэтому достаточно рассмотреть аппроксимацию $Df$ на основе ряда.

Рассмотрим ближайших соседей точки $z_i$ в пространстве $z$-векторов $z_{k_j}$ и произвольный вектор возмущения $u_i$.
Введем соответствующие разности как $y_j = z_{k_j} - z_i$.
Тогда очевидно, что $\hat{y}_j = Df [y_j] = z_{k_j+1} - z_{i+1}$.
Найдем разложение $u_i = \sum_{j} c_j y_j$ и будем считать, что $\widehat{Df[u]} = \hat{g} = \sum_j c_j \hat{y}_j$.
Далее этот вектор можно использовать для нахождения показателей Ляпунова при помощи алгоритма Бенеттина.

В реальных расчетах может оказаться, что вектор $u_i$ не лежит в линейной оболочке векторов $y_{k_j}$ и точного разложения не существует, или, наоборот, разложение не единственно.
Поэтому для отыскания коэффициентов $c_i$ ищут такой вектор $g = \sum_{j} c_j y_j$, что $\left( u_i, g \right) = 1,\; g^2 \to \min_{c}$, после чего найденный вектор нормируется.
В свою очередь, нахождение этого вектора сводится к решению определенной системы линейных уравнений.
